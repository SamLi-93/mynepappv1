angular.module('mynepapp.provincecontrollers', [])

// Sam 新建地址页面
.controller('CreateaddressCtrl', function($scope,$ionicPopup,$timeout,$http,Websites,$ionicLoading,$ionicHistory,$state,$stateParams) {

    //消息提示
    $scope.showMessage = function(title){
      $ionicLoading.show({
        template: title
      });
      $timeout(function() {
        $ionicLoading.hide();
      }, 1000);
    }

    var access_token = localStorage.access_token;
    $scope.data = {};
    $scope.address = {};
    $scope.data.username = $stateParams.text;
    $scope.data.phonenum = $stateParams.text;
    $scope.address.province = $stateParams.text;
    $scope.address.city = $stateParams.text;
    $scope.data.addresstext = $stateParams.text;


    $scope.saveaddress = function(){
    var phonenum = $scope.data.phonenum;
    var username = $scope.data.username;
    var addresstext = $scope.data.addresstext;
    var province = $scope.address.province;
    var city =$scope.address.city;
    console.log(username);
    console.log(addresstext);


    if (checkName(username)&&checkPhone(phonenum)&&checkAddress(addresstext)&&checkProvince(province)&&checkCity(city)) {
        $http.jsonp(ENV.yiiurl + 'mobileaddress/addaddress?access-token='+access_token+'&username='+ $scope.data.username+'&phonenum='+$scope.data.phonenum+'&province='+$scope.address.province+'&city='+$scope.address.city+'&address='+$scope.data.addresstext+'&callback=JSON_CALLBACK')
            .then(function(res){
              console.log('suc');
              $ionicLoading.show({ template: '保存成功', noBackdrop: true, duration: 1000 });
              $state.go('address', {}, { reload: true })
          })
      } else {
        if (!checkName(username)) {
            $scope.showMessage('请输入正确的收货人信息！');
        } else if(!checkPhone(phonenum)) {
            $scope.showMessage('请输入正确的联系方式！');
        } else if (!checkProvince(province)) {
            $scope.showMessage('请选择正确的省份！');
        } else if (!checkCity(city)) {
            $scope.showMessage('请选择正确的城市！');
        } else if (!checkAddress(addresstext)) {
            $scope.showMessage('请输入正确的地址！');
        }
      }
    }

    var checkName = function(b){
      var flag = false;
      if(b!=undefined){
        if(b.length>=2){
          flag = true;
        }
      }
      return flag;
    }

    var checkPhone = function(a){
      var str = /^(13[0-9]|14[0-9]|15[0-9]|18[0-9])\d{8}$/i;
      var flag = str.test(a);
      return flag;
    }

    var checkAddress = function(b){
      var flag = false;
      if(b!=undefined){
        if(b.length>=4){
          flag = true;
        }
      }
      return flag;
    }

    var checkProvince = function(a){
      var str = /[\u4e00-\u9fa5]+省|市/i;
      var flag = str.test(a);
      return flag;
    }

    var checkCity = function(a){
      var str = /[\u4e00-\u9fa5]+/i;
      var flag = str.test(a);
      return flag;
    }

  //back button
  $scope.$on('$ionicView.beforeEnter', function (event, viewData) {
      viewData.enableBack = true;
    });
  
  //返回的动画效果，默认情况下强制显示的返回button无动画效果
  $scope.$on('$ionicView.beforeLeave', function (event, viewData) {
    $ionicViewSwitcher.nextDirection("back");
  });
    
   $scope.provincelist = {
    "北京市": {
        "北京市": [
            "东城区"
        ]
    },
    "上海市": {
        "上海市": [
            "崇明县"
        ]
    },
    "天津市": {
        "天津市": [
            "蓟县"
        ]
    },
    "重庆市": {
        "重庆市": [
            "南川市"
        ]
    },
    "四川省": {
        "成都市": [
            "崇州市"
        ],
        "自贡市": [
            "富顺县"
        ],
        "攀枝花市": [
            "盐边县"
        ],
        "泸州市": [
            "古蔺县"
        ],
        "德阳市": [
            "绵竹市"
        ],
        "绵阳市": [
            "江油市"
        ],
        "广元市": [
            "苍溪县"
        ],
        "遂宁市": [
            "大英县"
        ],
        "内江市": [
            "隆昌县"
        ],
        "乐山市": [
            "峨眉山市"
        ],
        "南充市": [
            "阆中市"
        ],
        "眉山市": [
            "青神县"
        ],
        "宜宾市": [
            "屏山县"
        ],
        "广安市": [
            "华莹市"
        ],
        "达州市": [
            "万源市"
        ],
        "雅安市": [
            "宝兴县"
        ],
        "巴中市": [
            "平昌县"
        ],
        "资阳市": [
            "简阳市"
        ],
        "阿坝自治州": [
            "红原县"
        ],
        "甘孜自治州": [
            "得荣县"
        ],
        "凉山自治州": [
            "雷波县"
        ]
    },
    "贵州省": {
        "贵阳市": [
            "清镇市"
        ],
        "六盘水市": [
        ],
        "遵义市": [
 
        ],
        "安顺市": [

        ],
        "铜仁地区": [

        ],
        "黔西南自治州": [
  
        ],
        "毕节地区": [
        ],
        "黔东自治州": [

        ],
        "黔南自治州": [
        ]
    },
    "云南省": {
        "昆明市": [

        ],
        "曲靖市": [

        ],
        "玉溪市": [

        ],
        "保山市": [

        ],
        "昭通市": [
    
        ],
        "丽江市": [

        ],
        "思茅市": [

        ],
        "临沧市": [

        ],
        "楚雄自治州": [

        ],
        "红河自治州": [
 
        ],
        "文山自治州": [
  
        ],
        "西双版纳": [

        ],
        "大理自治州": [
        ],
        "德宏自治州": [

        ],
        "怒江自治州": [

        ],
        "迪庆自治州": [
   
        ]
    },
    "西藏省": {
        "拉萨市": [
      
        ],
        "昌都地区": [
        ],
        "山南地区": [
          
        ],
        "日喀则地区": [
       
        ],
        "那曲地区": [
      
        ],
        "阿里地区": [
         
        ],
        "林芝地区": [
     
        ]
    },
    "河南省": {
        "郑州市": [
      
        ],
        "开封市": [
       
        ],
        "洛阳市": [
          
        ],
        "平顶山市": [
         
        ],
        "安阳市": [
           
        ],
        "鹤壁市": [
            
        ],
        "新乡市": [
            
        ],
        "焦作市": [
           
        ],
        "濮阳市": [
            
        ],
        "许昌市": [
            
        ],
        "漯河市": [
           
        ],
        "三门峡市": [
           
        ],
        "南阳市": [

        ],
        "商丘市": [
           
        ],
        "信阳市": [
            
        ],
        "周口市": [
            
        ],
        "驻马店市": [
            
        ]
    },
    "湖北省": {
        "武汉市": [
           
        ],
        "黄石市": [
            
        ],
        "十堰市": [
            
        ],
        "宜昌市": [
            
        ],
        "襄樊市": [
            
        ],
        "鄂州市": [
            
        ],
        "荆门市": [
          
        ],
        "孝感市": [
           
        ],
        "荆州市": [
           
        ],
        "黄冈市": [
            
        ],
        "咸宁市": [
            
        ],
        "随州市": [
            
        ],
        "恩施自治州": [
           
        ]
    },
    "湖南省": {
        "长沙市": [
         
        ],
        "株洲市": [
         
        ],
        "湘潭市": [
            
        ],
        "衡阳市": [
            
        ],
        "邵阳市": [
            
        ],
        "岳阳市": [
           
        ],
        "常德市": [
            
        ],
        "张家界市": [
   
        ],
        "益阳市": [
  
        ],
        "郴州市": [
          
        ],
        "永州市": [
           
        ],
        "怀化市": [
           
        ],
        "娄底市": [
          
        ],
        "湘西自治州": [
          
        ]
    },
    "广东省": {
        "广州市": [
           
        ],
        "韶关市": [
           
        ],
        "深圳市": [
            
        ],
        "珠海市": [
            
        ],
        "汕头市": [
           
        ],
        "佛山市": [
           
        ],
        "江门市": [
            
        ],
        "湛江市": [
           
        ],
        "茂名市": [
            
        ],
        "肇庆市": [
            
        ],
        "惠州市": [
           
        ],
        "梅州市": [
           
        ],
        "汕尾市": [
            
        ],
        "河源市": [
            
        ],
        "阳江市": [
            
        ],
        "清远市": [
            
        ],
        "东莞市": [
            
        ],
        "中山市": [
         
        ],
        "潮州市": [
            
        ],
        "揭阳市": [
            
        ],
        "云浮市": [
            
        ]
    },
    "广西省": {
        "南宁市": [
           
        ],
        "柳州市": [
          
        ],
        "桂林市": [
           
        ],
        "梧州市": [
            
        ],
        "北海市": [
            
        ],
        "防城港市": [
            
        ],
        "钦州市": [
            
        ],
        "贵港市": [
            
        ],
        "玉林市": [
           
        ],
        "百色市": [
          
        ],
        "贺州市": [
            
        ],
        "河池市": [
          
        ],
        "来宾市": [
            
        ],
        "崇左市": [
            
        ]
    },
    "陕西省": {
        "西安市": [
           
        ],
        "铜川市": [
            
        ],
        "宝鸡市": [
            
        ],
        "咸阳市": [
            
        ],
        "渭南市": [
            
        ],
        "延安市": [
            
        ],
        "汉中市": [
            
        ],
        "榆林市": [
           
        ],
        "安康市": [
            
        ],
        "商洛市": [
            
        ]
    },
    "甘肃省": {
        "兰州市": [
            
        ],
        "嘉峪关市": [

        ],
        "金昌市": [
            
        ],
        "白银市": [
           
        ],
        "天水市": [
           
        ],
        "武威市": [
           
        ],
        "张掖市": [
            
        ],
        "平凉市": [
            
        ],
        "酒泉市": [
            
        ],
        "庆阳市": [
            "镇原县"
        ],
        "定西市": [
            "岷县"
        ],
        "陇南市": [
            "两当县"
        ],
        "临夏自治州": [
            "积石山自治县"
        ],
        "甘南自治州": [
            "夏河县"
        ]
    },
    "青海省": {
        "西宁市": [
            "湟源县"
        ],
        "海东地区": [
            "循化自治县"
        ],
        "海北藏族自治州": [
            "刚察县"
        ],
        "黄南自治州": [
        ],
        "海南自治州": [
            "贵南县"
        ],
        "果洛自治州": [
            "玛多县"
        ],
        "玉树自治州": [
            "曲麻莱县"
        ],
        "海西自治州": [
            "天峻县"
        ]
    },
    "宁夏省": {
        "银川市": [
            "灵武市"
        ],
        "石嘴山市": [
            "平罗县"
        ],
        "吴忠市": [
            "青铜峡市"
        ],
        "固原市": [
            "海原县"
        ],
        "中卫市": [
            "中宁县"
        ]
    },
    "新疆省": {
        "乌鲁木齐市": [
            "乌鲁木齐县"
        ],
        "克拉玛依市": [
            "乌尔禾区"
        ],
        "吐鲁番地区": [
            "托克逊县"
        ],
        "哈密地区": [
            "伊吾县"
        ],
        "喀什地区": [
        ],
        "和田地区": [
            "民丰县"
        ],
        "伊犁自治州": [
            "尼勒克县"
        ],
        "塔城地区": [
            "裕民县"
        ],
        "阿勒泰地区": [
            "吉木乃县"
        ],
    },
    "河北省": {
        "石家庄市": [
            "鹿泉市"
        ],
        "唐山市": [
            "迁安市"
        ],
        "秦皇岛市": [
            "卢龙县"
        ],
        "邯郸市": [
            "武安市"
        ],
        "邢台市": [
            "沙河市"
        ],
        "保定市": [
            "高碑店市"
        ],
        "张家口市": [
            "崇礼县"
        ],
        "承德市": [
            "隆化县"
        ],
        "沧州市": [
            "河间市"
        ],
        "廊坊市": [
            "三河市"
        ],
        "衡水市": [
            "深州市"
        ]
    },
    "山西省": {
        "太原市": [
            "古交市"
        ],
        "大同市": [
            "大同县"
        ],
        "阳泉市": [
            "盂县"
        ],
        "长治市": [
            "潞城市"
        ],
        "晋城市": [
            "高平市"
        ],
        "朔州市": [
            "怀仁县"
        ],
        "晋中市": [
            "介休市"
        ],
        "运城市": [
            "河津市"
        ],
        "忻州市": [
            "原平市"
        ],
        "临汾市": [
            "霍州市"
        ],
        "吕梁市": [
            "汾阳市"
        ]
    },
    "内蒙古省": {
        "呼和浩特市": [
            "武川县"
        ],
        "包头市": [
        ],
        "乌海市": [
            "乌达区"
        ],
        "赤峰市": [
            "敖汉旗"
        ],
        "通辽市": [
        ],
        "鄂尔多斯市": [
        ],
        "呼伦贝尔市": [
            "根河市"
        ],
        "乌兰察布市": [
            "丰镇市"
        ],
    },
    "江苏省": {
        "南京市": [
            "高淳县"
        ],
        "无锡市": [
            "宜兴市"
        ],
        "徐州市": [
            "邳州市"
        ],
        "常州市": [
            "金坛市"
        ],
        "苏州市": [
            "太仓市"
        ],
        "南通市": [
            "海门市"
        ],
        "连云港市": [
            "灌南县"
        ],
        "淮安市": [
            "金湖县"
        ],
        "盐城市": [
            "大丰市"
        ],
        "扬州市": [
            "江都市"
        ],
        "镇江市": [
            "句容市"
        ],
        "泰州市": [
            "姜堰市"
        ],
        "宿迁市": [
            "泗洪县"
        ]
    },
    "浙江省": {
        "杭州市": [
            "临安市"
        ],
        "宁波市": [
            "奉化市"
        ],
        "温州市": [
            "乐清市"
        ],
        "嘉兴市": [
            "桐乡市"
        ],
        "湖州市": [
            "安吉县"
        ],
        "绍兴市": [
            "嵊州市"
        ],
        "金华市": [
            "永康市"
        ],
        "衢州市": [
            "江山市"
        ],
        "舟山市": [
            "嵊泗县"
        ],
        "台州市": [
            "临海市"
        ],
        "丽水市": [
            "龙泉市"
        ]
    },
    "安徽省": {
        "合肥市": [
            "肥西县"
        ],
        "芜湖市": [
            "南陵县"
        ],
        "蚌埠市": [
            "固镇县"
        ],
        "淮南市": [
            "凤台县"
        ],
        "马鞍山市": [
            "当涂县"
        ],
        "淮北市": [
            "濉溪县"
        ],
        "铜陵市": [
            "铜陵县"
        ],
        "安庆市": [
            "桐城市"
        ],
        "黄山市": [
            "祁门县"
        ],
        "滁州市": [
            "明光市"
        ],
        "阜阳市": [
            "界首市"
        ],
        "宿州市": [
            "泗县"
        ],
        "巢湖市": [
            "和县"
        ],
        "六安市": [
            "霍山县"
        ],
        "亳州市": [
            "利辛县"
        ],
        "池州市": [
            "青阳县"
        ],
        "宣城市": [
            "宁国市"
        ]
    },
    "福建省": {
        "福州市": [
            "长乐市"
        ],
        "厦门市": [
            "翔安区"
        ],
        "莆田市": [
            "仙游县"
        ],
        "三明市": [
            "永安市"
        ],
        "泉州市": [
            "南安市"
        ],
        "漳州市": [
            "龙海市"
        ],
        "南平市": [
            "建阳市"
        ],
        "龙岩市": [
            "漳平市"
        ],
        "宁德市": [
            "福鼎市"
        ]
    },
    "江西省": {
        "南昌市": [
            "进贤县"
        ],
        "景德镇市": [
            "乐平市"
        ],
        "萍乡市": [
            "芦溪县"
        ],
        "九江市": [
            "瑞昌市"
        ],
        "新余市": [
            "分宜县"
        ],
        "鹰潭市": [
            "贵溪市"
        ],
        "赣州市": [
            "南康市"
        ],
        "吉安市": [
            "井冈山市"
        ],
        "宜春市": [
            "高安市"
        ],
        "抚州市": [
            "广昌县"
        ],
        "上饶市": [
            "德兴市"
        ]
    },
    "山东省": {
        "济南市": [
            "章丘市"
        ],
        "青岛市": [
            "莱西市"
        ],
        "淄博市": [
            "沂源县"
        ],
        "枣庄市": [
            "滕州市"
        ],
        "东营市": [
            "广饶县"
        ],
        "烟台市": [
            "海阳市"
        ],
        "潍坊市": [
            "昌邑市"
        ],
        "济宁市": [
            "邹城市"
        ],
        "泰安市": [
            "肥城市"
        ],
        "威海市": [
            "乳山市"
        ],
        "日照市": [
            "莒县"
        ],
        "莱芜市": [
            "钢城区"
        ],
        "临沂市": [
            "临沭县"
        ],
        "德州市": [
            "禹城市"
        ],
        "聊城市": [
            "临清市"
        ],
        "滨州市": [
            "邹平县"
        ],
        "荷泽市": [
            "东明县"
        ]
    },
    "辽宁省": {
        "沈阳市": [
            "新民市"
        ],
        "大连市": [
            "庄河市"
        ],
        "鞍山市": [
            "海城市"
        ],
        "抚顺市": [
            "抚顺县"
        ],
        "本溪市": [
        ],
        "丹东市": [
            "凤城市"
        ],
        "锦州市": [
            "北宁市"
        ],
        "营口市": [
            "大石桥市"
        ],
        "阜新市": [
            "彰武县"
        ],
        "辽阳市": [
            "灯塔市"
        ],
        "盘锦市": [
            "盘山县"
        ],
        "铁岭市": [
            "开原市"
        ],
        "朝阳市": [
            "凌源市"
        ],
        "葫芦岛市": [
            "兴城市"
        ]
    },
    "吉林省": {
        "长春市": [
            "德惠市"
        ],
        "吉林市": [
            "磐石市"
        ],
        "四平市": [
            "双辽市"
        ],
        "辽源市": [
            "东辽县"
        ],
        "通化市": [
            "集安市"
        ],
        "白山市": [
            "临江市"
        ],
        "松原市": [
            "扶余县"
        ],
        "白城市": [
            "大安市"
        ],
    },
    "黑龙江省": {
        "哈尔滨市": [
            "五常市"
        ],
        "齐齐哈尔市": [
            "讷河市"
        ],
        "鸡西市": [
            "密山市"
        ],
        "鹤岗市": [
            "绥滨县"
        ],
        "双鸭山市": [
            "饶河县"
        ],
        "大庆市": [
            "林甸县"
        ],
        "伊春市": [
            "铁力市"
        ],
        "佳木斯市": [
            "富锦市"
        ],
        "七台河市": [
            "勃利县"
        ],
        "牡丹江市": [
            "穆棱市"
        ],
        "黑河市": [
            "五大连池市"
        ],
        "绥化市": [
            "海伦市"
        ],
        "大兴安岭地区": [
            "漠河县"
        ]
    },
    "海南省": {
        "海口市": [
            "美兰区"
        ],
        "三亚市": [
            "三亚市"
        ],
    }
};

});